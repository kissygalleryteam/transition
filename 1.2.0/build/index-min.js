KISSY.add(function(n,i,t){function o(){var n={"-webkit-":"webkitAnimationEnd","-moz-":"animationend","-o-":"oAnimationEnd animationend","-ms-":"animationend","":"animationend"},i=a();return n[i]}function e(){return this instanceof e?void(this.isTransitioning=!1):new e}function a(){var n,i=document.createElement("fake"),t={WebkitTransition:"-webkit-",transition:"-ms-",OTransition:"-o-",MozTransition:"-moz-"};for(n in t)if(void 0!==i.style[n])return t[n];return""}function r(n,t){"string"==typeof t&&(t=[t]),i.addClass(n,t.join(" "))}function s(n,t){"string"==typeof t&&(t=[t]),i.removeClass(n,t.join(" "))}var f=o();return n.augment(e,t.Target),n.augment(e,{transition:function(n){function o(n,i){return"mb-"+e.transitionType+" "+n+(i?" reverse":"")}var e=this;if(!this.isTransitioning){var a=e.transitionType=n.transition,u=n.container&&i.get(n.container),c=i.get(n.fromView),m=i.get(n.toView),d=!!n.reverse,l=n.showToViewDelay,v="mb-anim-view-active";this.isTransitioning=!0,"flip"===a&&u&&i.addClass(u,"mb-flip-container"),d?setTimeout(function(){r(m,o("out",d)),l?t.on(m,f,function(){i.removeClass(m,v),r(c,[o("in",d),v]),t.detach(m,f)}):r(c,[o("in",d),v])},0):setTimeout(function(){r(c,o("out",d)),l?t.on(c,f,function(){i.removeClass(c,v),r(m,[o("in",d),v]),t.detach(c,f)}):r(m,[o("in",d),v])},0);var T=d?c:m;t.on(T,f,function(){"flip"===a&&u&&i.removeClass(u,"mb-flip-container"),d?(s(c,[o("in",d)]),s(m,[o("out",d),v])):(s(c,[o("out",d),v]),s(m,[o("in",d)])),t.detach(T,f),window.scrollTo(0,0),e.isTransitioning=!1,e.fire(a+"End")})}},slide:function(n){n.transition="slide",this.transition(n)},fade:function(n){n.transition="fade",this.transition(n)},flip:function(n){n.transition="flip",this.transition(n)}}),e},{requires:["dom","event"]});