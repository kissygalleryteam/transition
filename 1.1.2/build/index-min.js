KISSY.add(function(i,n,t){function o(){return this instanceof o?void(this.isTransitioning=!1):new o}function e(){var i,n=document.createElement("fake"),t={WebkitTransition:"-webkit-",transition:"-ms-",OTransition:"-o-",MozTransition:"-moz-"};for(i in t)if(void 0!==n.style[i])return t[i];return""}function r(i,t){"string"==typeof t&&(t=[t]),n.addClass(i,t.join(" "))}function s(i,t){"string"==typeof t&&(t=[t]),n.removeClass(i,t.join(" "))}{var a="-webkit-"===e()?"webkitAnimationEnd":"animationend";"-webkit-"===e()?"webkitTransitionEnd":"transitionend"}return i.augment(o,t.Target),i.augment(o,{transition:function(i){function o(i,n){return"mb-"+e.transitionType+" "+i+(n?" reverse":"")}var e=this;if(!this.isTransitioning){var f=e.transitionType=i.transition,u=i.container&&n.get(i.container),c=n.get(i.fromView),d=n.get(i.toView),m=!!i.reverse,l="mb-anim-view-active";this.isTransitioning=!0,"flip"===f&&u&&n.addClass(u,"mb-flip-container"),m?setTimeout(function(){r(c,[o("in",m),l]),r(d,o("out",m))},0):setTimeout(function(){r(c,o("out",m)),r(d,[o("in",m),l])},0);var v=m?c:d;t.on(v,a,function(){"flip"===f&&u&&n.removeClass(u,"mb-flip-container"),m?(s(c,[o("in",m)]),s(d,[o("out",m),l])):(s(c,[o("out",m),l]),s(d,[o("in",m)])),t.detach(v,a),window.scrollTo(0,0),e.isTransitioning=!1,e.fire(f+"End")})}},slide:function(i){i.transition="slide",this.transition(i)},fade:function(i){i.transition="fade",this.transition(i)},flip:function(i){i.transition="flip",this.transition(i)}}),o},{requires:["dom","event"]});